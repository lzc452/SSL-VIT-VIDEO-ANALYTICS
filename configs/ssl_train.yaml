dataset:
  name: UCF101
  train_split: UCF101_train.txt
  val_split: UCF101_val.txt

training:
  epochs: 200
  batch_size: 48
  learning_rate: 0.0005
  weight_decay: 0.05
  save_every: 10
  save_dir: results/ema_ssl_vicreg
  amp: true
  clip_grad_norm: 1.0
  log_interval: 20
  num_workers: 4

  scheduler:
    enable: true
    warmup_epochs: 5
    eta_min_ratio: 0.05

model:
  backbone: mobilevit_s
  embed_dim: 256
  temporal_layers: 4
  temporal_heads: 4

ssl_objectives:
  # -------- MFM (Teacher-Student) --------
  mask_ratio: 0.75
  mfm_weight: 1.0
  ema_momentum: 0.996

  # VICReg-style variance constraint (anti-collapse)
  var_weight: 25.0
  var_eps: 0.0001
  var_target_std: 1.0

  # -------- TOP (Permutation classification) --------
  top_weight: 1.0
  top_start_epoch: 6
  top_every: 2              # OOM safeguard: run TOP every N steps
  top_subsample: 0.5        # OOM safeguard: only use a subset of batch for TOP
  top_detach_backbone: false # if true, TOP only trains head (very stable but weaker)

optimizer:
  type: adamw